<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>Ø±ÙØ¹ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¬ÙˆØ§Ø¦Ø² Ø¥Ù„Ù‰ Supabase</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 600px;
      margin: auto;
      background: #f9f9f9;
      color: #333;
    }
    textarea {
      width: 100%;
      height: 120px;
      padding: 8px;
      font-size: 1em;
      border: 1px solid #ccc;
      border-radius: 5px;
      resize: vertical;
      box-sizing: border-box;
    }
    select, button {
      font-size: 1em;
      padding: 10px 15px;
      margin-top: 10px;
      border-radius: 5px;
      border: 1px solid #4caf50;
      cursor: pointer;
      box-sizing: border-box;
    }
    select {
      width: 100%;
      background: white;
      color: #333;
    }
    button {
      background-color: #4caf50;
      color: white;
      border: none;
      font-weight: bold;
      width: 100%;
    }
    button:hover {
      background-color: #45a049;
    }
    #status {
      margin-top: 15px;
      min-height: 30px;
      padding: 10px;
      border-radius: 5px;
      font-weight: bold;
    }
    #status.info { background-color: #e3f2fd; color: #1e88e5; }
    #status.success { background-color: #e8f5e9; color: #2e7d32; }
    #status.error { background-color: #fdecea; color: #e74c3c; }
    #status.warning { background-color: #fffde7; color: #fdd835; }
  </style>
</head>
<body>

  <h2 style="text-align:center; margin-bottom: 20px;">ğŸ Ø±ÙØ¹ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¬ÙˆØ§Ø¦Ø² Ø¥Ù„Ù‰ Supabase</h2>

  <label for="linkType">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø±Ø§Ø¨Ø·:</label>
  <select id="linkType">
    <option value="Super Fertilizer">Ø³Ù…Ø§Ø¯ Ø®Ø§Ø±Ù‚</option>
    <option value="Super Watering Can">Ø¯Ù„Ùˆ Ø³Ù‚Ø§ÙŠØ© Ø®Ø§Ø±Ù‚</option>
    <option value="Bingo">Ø¨ÙŠÙ†Ø¬Ùˆ</option>
    <option value="normalfert">125 Ø³Ù…Ø§Ø¯ Ø·Ø¨ÙŠØ¹ÙŠ</option>
    <option value="Energy">Ø·Ø§Ù‚Ø©</option>
    <option value="Other">Ø£Ø®Ø±Ù‰ (Ø¹Ø§Ù…)</option>
  </select>

  <br /><br />

  <label for="linksInput">Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· (ÙƒÙ„ Ø±Ø§Ø¨Ø· ÙÙŠ Ø³Ø·Ø± Ø¬Ø¯ÙŠØ¯):</label>
  <textarea id="linksInput" placeholder="https://example.com/link1
https://example.com/link2"></textarea>

  <button id="uploadBtn">ğŸš€ Ø±ÙØ¹ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</button>

  <div id="status" class="info" style="display:none;"></div>

  <script>
    // Ø¥Ø¹Ø¯Ø§Ø¯ Supabase
    const SUPABASE_URL = 'https://wuauxagghhzqrxgotcqo.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind1YXV4YWdnaGh6cXJ4Z290Y3FvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0NjU3NzYsImV4cCI6MjA2ODA0MTc3Nn0.W7Ayyfdh3qmrfzw_F5t35umQZRIdmqKENNdk3HYcNVE';
    const SUPABASE_TABLE = 'reward_links';

    // Ø£Ù†Ø´Ø¦ Ø¹Ù…ÙŠÙ„ Supabase (Ù…Ù‡Ù…: Ø§Ø³Ù… Ø§Ù„Ù…ÙƒØªØ¨Ø© supabase ÙˆÙ„ÙŠØ³ supabaseJs)
    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const uploadBtn = document.getElementById('uploadBtn');
    const statusDiv = document.getElementById('status');

    function showStatus(message, type = 'info') {
      statusDiv.style.display = 'block';
      statusDiv.textContent = message;
      statusDiv.className = type;
    }

    uploadBtn.addEventListener('click', async () => {
      showStatus('â³ Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·...', 'info');
      const type = document.getElementById('linkType').value;
      const rawLinks = document.getElementById('linksInput').value.trim();

      if (!rawLinks) {
        showStatus('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±ÙˆØ§Ø¨Ø· ØµØ­ÙŠØ­Ø©.', 'warning');
        return;
      }

      const links = rawLinks.split('\n').map(l => l.trim()).filter(l => l.length > 0);

      let successCount = 0;

      for (const link of links) {
        try {
          const { error } = await supabase
            .from(SUPABASE_TABLE)
            .insert([{ link_url: link, link_type: type, status: 'new' }]);

          if (!error) {
            successCount++;
          } else {
            console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„:', error);
          }
        } catch (e) {
          console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„:', e);
        }
      }

      showStatus(`âœ… ØªÙ… Ø±ÙØ¹ ${successCount} Ø±Ø§Ø¨Ø· Ù…Ù† Ø£ØµÙ„ ${links.length}.`, 'success');
    });
  </script>

</body>
</html>
